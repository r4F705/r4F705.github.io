[{"content":"","date":"21 July 2023","permalink":"/bug-bounty/","section":"Bug-bounties","summary":"","title":"Bug-bounties"},{"content":"","date":"21 July 2023","permalink":"/tags/cve/","section":"Tags","summary":"","title":"cve"},{"content":"","date":"21 July 2023","permalink":"/tags/docker/","section":"Tags","summary":"","title":"docker"},{"content":" JWT Token Forgery for Haystack\u0026rsquo;s Annotator Tool (CVE-2023-1712) # Introduction # The purpose of this disclosure is to ethically report a web vulnerability found in the Annotator Tool. By analyzing the provided docker image, it was possible to gain access to the source code and identify a critical security flaw related to the generation of JSON Web Tokens (JWTs). This vulnerability allows low-level users to escalate their privileges and perform actions that were previously restricted.\nVulnerability Details # The vulnerability stems from a hardcoded value found in the configuration file config/config.production.js. Specifically, the value of config.jwt.secret = Hm************tA is used to sign JWT tokens. Exploiting this weakness enables an attacker to create new JWT tokens with the \u0026ldquo;super_admin\u0026rdquo; role, granting unauthorized access and privileges.\nExploitation Method # To exploit this vulnerability, the attacker needs to replicate the token generation process used by the application. This can be achieved by modifying the existing back-end code of the annotation tool. The following lines can be added to the getSignedJWT function in app/service/userService.js:\nconst fs = require(\u0026#34;fs\u0026#34;); let x = this.app.jwt.sign( { id: 2, email: \u0026#34;r4F705@proxy.com\u0026#34;, role: \u0026#34;super_admin\u0026#34;, }, \u0026#34;Hm************tA\u0026#34; ); fs.writeFile(\u0026#34;/tmp/test.txt\u0026#34;, x, (err) =\u0026gt; { if (err) { console.error(err); } }); By incorporating this code snippet into a modified version of the back-end, the attacker can host a local instance of the application. Logging in with a regular user account on the modified instance will generate a new JWT token with the \u0026ldquo;super_admin\u0026rdquo; role. To utilize this forged token, the attacker can retrieve it from /tmp/test.txt within the running container or the host system. Then, by updating the value of the \u0026ldquo;dpst-token\u0026rdquo; found in the browser\u0026rsquo;s local storage for the original login domain, the attacker can assume the elevated privileges associated with the \u0026ldquo;super_admin\u0026rdquo; role.\nlogged in as admin at deepset.ai Impact # This vulnerability has significant implications for all current versions of the annotation tool, regardless of whether they are hosted online or within a company\u0026rsquo;s internal network. Since the containers utilized by the tool share the same secret key, any forged tokens created using the vulnerability will be effective across all instances of the tool.\nThe impact of this vulnerability is twofold, affecting both the integrity and availability of the tool and its associated data. Exploiting the vulnerability allows an attacker to gain super admin access without the need for a valid account, posing a severe security risk. With super admin privileges, an attacker can masquerade as any other user, leading to unauthorized modifications to the annotation process and the potential corruption of valuable training data for QA models. As a result, the reliability and trustworthiness of the annotation tool\u0026rsquo;s outputs are compromised.\nFurthermore, an attacker can leverage scripted attacks to remove created users, significantly impeding the functionality and usability of the tool. The removal of user accounts can disrupt workflows and impede collaboration, rendering the tool\u0026rsquo;s usage challenging and hindering productivity.\nOriginally reported on huntr\n","date":"21 July 2023","permalink":"/bug-bounty/haystack/","section":"Bug-bounties","summary":"JWT Token Forgery for Haystack\u0026rsquo;s Annotator Tool (CVE-2023-1712) # Introduction # The purpose of this disclosure is to ethically report a web vulnerability found in the Annotator Tool.","title":"Haystack"},{"content":"","date":"21 July 2023","permalink":"/tags/jwt/","section":"Tags","summary":"","title":"jwt"},{"content":"","date":"21 July 2023","permalink":"/","section":"r4f705's blog","summary":"","title":"r4f705's blog"},{"content":"","date":"21 July 2023","permalink":"/tags/reversing/","section":"Tags","summary":"","title":"reversing"},{"content":"","date":"21 July 2023","permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"","date":"21 July 2023","permalink":"/tags/web/","section":"Tags","summary":"","title":"web"},{"content":"","date":"21 July 2023","permalink":"/tags/arm/","section":"Tags","summary":"","title":"arm"},{"content":" Lists # To define a list of items, just put a *, a -, or a + at the start of the line of each item of the list followed by at least a space, to end the list, leave a blank line\nred green blue white grey black yellow pink orange You can also define numbered list, putting a number followed by a . or a ) and a space at the start of the line (you may use any number, the first one is taken to start counting, then it will increment by one):\nyou may leave blank items or start again You can insert any block inside a list, you have to respect the indentation of the text of the list item\nA paragraph of text (spanning multiple lines),\nfenced code, indented code (4 spaces + 2 spaces for the list indentation, one blank line above, one below), quotes,\nanother list (and so on\u0026hellip;), or headers # ","date":"21 July 2023","permalink":"/binary/arm-antidote/","section":"Binaries","summary":"Lists # To define a list of items, just put a *, a -, or a + at the start of the line of each item of the list followed by at least a space, to end the list, leave a blank line","title":"ARM Antidote"},{"content":"","date":"21 July 2023","permalink":"/binary/","section":"Binaries","summary":"","title":"Binaries"},{"content":" Headers # There are two ways to define headers:\nThe biggest possible header # You can also use this markup # (I prefer the first one as it\u0026rsquo;s more readable when looking directly at the source code)\nA sub heading # This is the alternative format # Then you can go smaller # And smaller # And even smaller # No, you can\u0026rsquo;t go smaller than this # The good thing is that many tools that convert Markdown in HTML or PDF are able to generate the index of your document, or links to the headers automatically (like Github does on the source of Markdown files)\n","date":"21 July 2023","permalink":"/web/easter-bunny/","section":"Webs","summary":"Headers # There are two ways to define headers:","title":"Easter Bunny"},{"content":"","date":"21 July 2023","permalink":"/tags/poisoning/","section":"Tags","summary":"","title":"poisoning"},{"content":"","date":"21 July 2023","permalink":"/tags/pwn/","section":"Tags","summary":"","title":"pwn"},{"content":"","date":"21 July 2023","permalink":"/tags/varnish/","section":"Tags","summary":"","title":"varnish"},{"content":"","date":"21 July 2023","permalink":"/web/","section":"Webs","summary":"","title":"Webs"},{"content":"","date":"1 January 0001","permalink":"/authors/","section":"Authors","summary":"","title":"Authors"},{"content":"","date":"1 January 0001","permalink":"/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"","date":"1 January 0001","permalink":"/series/","section":"Series","summary":"","title":"Series"}]